<!DOCTYPE html>
<html lang="zh-Hans">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvas</title>
    <style >
        body{margin: 0;}
        #canvas{background:;}
        .actions{position: fixed; left: 0; top: 0; border-radius: 10px;}
        .actions > #brush{display: none;}
        .actions.x > #brush{display: inline-block;}
        .actions.x > #eraser{display: none;}
    </style>
    <style type="text/css">
        .icon {
           width: 2em; height: 2em;
           vertical-align: -0.15em;
           fill: currentColor;
           overflow: hidden;
        }
    </style>
    
    <script src="//at.alicdn.com/t/font_1933332_lyxyd5gbtp.js"></script>
</head>
<body>
    <canvas id = "canvas"></canvas> <!--注意不能用css给宽,用JS给属性，而不是给样式-->
    <div id="actions" class="actions">
        <button id="eraser"><svg class="icon" aria-hidden="true">
            <use xlink:href="#icon-huabi"></use>
        </svg></button>
        <button id="brush"><svg class="icon" aria-hidden="true">
            <use xlink:href="#icon-Eraser-Tool"></use>
        </svg></button>
    </div>
    


    <script>
        var Canvas = document.getElementById('canvas');
        var context = Canvas.getContext('2d');
        autosetCanvasSize(Canvas)
        listenTomouse(Canvas)

        // ----------------用户页面事件-------------//
        function autosetCanvasSize(Canvas){
            setCanvasSize()  // 先获取用户页面宽高
            window.onresize = function () {  // 然后监听用户页面宽高，如果改变重新获取
                setCanvasSize()
             }
            function setCanvasSize() { 
                var pageWidth = document.documentElement.clientWidth
                var pageHeight = document.documentElement.clientHeight
                Canvas.width = pageWidth
                Canvas.height = pageHeight
            }
        }

        //--------------鼠标事件----------------//
        function listenTomouse(Canvas) {
                //----------画圈-------------//
                function drawCircle(x, y, radius) {
                    context.beginPath()
                    // context.fillStyle = "black";
                    context.arc(x, y, radius, 0, Math.PI * 2);
                    context.fill()
                    context.closePath()
                }
                
                //----------画线-------------//
                function drawLine(x1, y1, x2, y2) {
                    context.beginPath()
                    // context.strokeStyle = "black";
                    context.lineWidth = 4     //注意lineWidth的 W 是大写
                    context.moveTo(x1, y1)
                    context.lineTo(x2, y2)
                    context.stroke()
                    context.closePath()
                }

                
                var using = false//(初始值)
                var lastpoint = { x: undefined, y: undefined }

                //----------鼠标按下-----------------//
                Canvas.onmousedown = function (a) {
                    using = true
                    var x = a.clientX
                    var y = a.clientY
                    if (eraserEnabled) {
                        context.clearRect(x - 5, y - 5, 20, 20)
                    } else {
                        lastpoint = { 'x': x, 'y': y }
                        drawCircle(x, y, 2)
                    }
                }

                //--------------鼠标移动------------//
                Canvas.onmousemove = function (a) {
                    var x = a.clientX
                    var y = a.clientY
                    if (eraserEnabled) { //先判断橡皮擦按钮有没有打开
                        if (using) { //再判断有没有点击画布
                            context.clearRect(x - 5, y - 5, 10, 10)
                        }
                    } else {
                        if (using) {
                            newpoint = { 'x': x, 'y': y }
                            drawLine(lastpoint.x, lastpoint.y, newpoint.x, newpoint.y,)
                            lastpoint = newpoint
                        }
                    }
                }

                //---------------鼠标松开--------------//
                Canvas.onmouseup = function (a) {
                    using = false
                }
            }  
    
      
        /************************/

        var eraserEnabled = false//橡皮擦初始值为false(关闭)
        //-------------橡皮擦点击-----------------//
        eraser.onclick = function(){
            //eraserEnabled = !eraserEnabled鼠标点橡皮擦时切换状态（开/关）
            eraserEnabled = true
            actions.className = 'actions x'
        }

        brush.onclick = function(){
            eraserEnabled = false
            actions.className = 'actions'
        }


        // var count = 0;
        // var arr = []
        // for(var i = 0; i<5; i++){
        //     Newarr = [];
        //     for(var j = 0; j<5; j++){
                
        //         Newarr.push(++count);
        //     }
        //     arr.push(Newarr);
        // }
        // console.log(arr);
    </script>
</body>
</html>